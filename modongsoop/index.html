<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>모여봐요 코딩의 숲 - 학교 축제 대모험</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* 낚시 타겟 강제 스타일 */
        #fishing-bar-bg {
            width: 100%; height: 40px; background: #ddd;
            border-radius: 20px; margin: 20px 0;
            position: relative; overflow: hidden; border: 2px solid #999;
        }
        #fishing-target {
            position: absolute; height: 100%; background: #ffeb3b;
            opacity: 0.8; z-index: 5; display: block; top: 0;
        }
        #fishing-cursor {
            position: absolute; height: 100%; width: 10px; background: #ff4444;
            left: 0; border-radius: 5px; z-index: 10; top: 0;
        }
        /* 벌 피하기 타이머 스타일 */
        #bee-timer-ui {
            position: absolute; top: 20%; left: 50%; transform: translate(-50%, -50%);
            font-size: 50px; color: red; font-weight: bold; font-family: 'Gaegu', cursive;
            text-shadow: 2px 2px 0px white; display: none; z-index: 50; pointer-events: none;
        }

        /* [수정] 엔딩 화면 스타일 최적화 (한 화면에 다 들어오도록) */
        #ending-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            color: white;
            display: none; /* JS에서 flex로 변경됨 */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            font-family: 'Gaegu', cursive;
        }
        #ending-screen h1 {
            font-size: 50px; /* 60px -> 50px 축소 */
            margin: 0 0 10px 0;
            color: gold;
            text-shadow: 3px 3px 0 #000;
        }
        .ending-msg {
            font-size: 24px; /* 30px -> 24px 축소 */
            color: white;
            margin: 5px 0;
        }
        #final-time-text {
            font-size: 30px; /* 35px -> 30px 축소 */
            color: #ffeb3b;
            margin: 10px 0;
            font-weight: bold;
            text-shadow: 2px 2px 0 #000;
        }
        .ranking-box {
            background: rgba(255,255,255,0.15);
            padding: 15px 30px; /* 패딩 축소 */
            border-radius: 20px;
            margin: 15px 0; /* 마진 축소 */
            width: 380px; /* 너비 약간 조정 */
            border: 2px solid gold;
        }
        .ranking-box h3 {
            font-size: 24px; /* 28px -> 24px 축소 */
            color: gold;
            margin: 0 0 10px 0;
            text-shadow: 1px 1px 2px black;
        }
        #ranking-list {
            font-size: 20px; /* 24px -> 20px 축소 */
            text-align: left;
            padding-left: 20px;
            line-height: 1.5;
            color: white;
        }
        .footer-msg {
            font-size: 18px; /* 20px -> 18px 축소 */
            color: #ccc;
            margin-top: 10px;
        }
        .restart-btn {
            padding: 10px 30px;
            font-size: 22px;
            font-family: 'Gaegu';
            background: #ff7f50;
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 4px 0 #b35938;
            transition: transform 0.1s;
        }
        .restart-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }
    </style>
</head>
<body>

<div class="assets" style="display: none;">
    <img id="npc-nook" src="images/nook.png" alt="너굴">
    <img id="npc-isabelle" src="images/yeoul.png" alt="여울">
    <img id="npc-blathers" src="images/boo.png" alt="부엉">
    <img id="npc-leon" src="images/reon.png" alt="레온">

    <img id="tree-img" src="images/namu.png" alt="나무">
    <img id="player-img" src="images/player.png" alt="플레이어">
    <img id="school-building-img" src="images/school.png" alt="학교 건물">
    <img id="pond-img" src="images/pond.png" alt="연못/강">
    <img id="codegeeks-logo" src="images/codegeeks.png" alt="CodeGeeks 로고">
</div>

<div id="intro-screen" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #fff8e1; color: #4a3b2a; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; font-family: 'Gaegu', cursive; text-align: center;">

    <div id="branding-group" style="display: flex; flex-direction: column; align-items: center; margin-bottom: 20px;">
        <img src="images/codegeeks.png" alt="CodeGeeks Logo" style="width: 280px; height: auto; margin-bottom: 10px;">
        <h1 id="intro-text" style="font-size: 60px; margin: 0; font-weight: bold; color: #5d4037;">🌳 모여봐요 코딩의 숲 🌳</h1>
    </div>

    <div id="name-input-area" style="background: white; padding: 30px; border-radius: 20px; border: 4px solid #8B4513; box-shadow: 0 10px 0 #d8b88d;">
        <p style="font-size: 24px; margin-bottom: 15px; font-weight: bold;">학생(선생님)의 이름을 알려주세요!</p>
        <input type="text" id="player-name-input" placeholder="이름 입력 (최대 6글자)" maxlength="6" style="font-family: 'Gaegu'; font-size: 28px; padding: 10px; border-radius: 10px; border: 2px solid #8B4513; text-align: center; width: 250px;">
        <br>
        <button onclick="startGame()" style="font-family: 'Gaegu'; font-size: 28px; padding: 10px 40px; background: #8B4513; color: white; border: none; border-radius: 15px; cursor: pointer; margin-top: 20px; box-shadow: 0 5px 0 #5d2e0d;">축제 즐기러 가기!</button>
    </div>
</div>

<div id="game-wrapper">
    <div id="timer-display" style="position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.6); color: white; padding: 8px 15px; border-radius: 15px; font-size: 22px; z-index: 10; font-family: 'Gaegu'; display: none;">시간: 0.00초</div>
    <div id="bee-timer-ui">10.00</div>

    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <div id="status-bar">
        <div id="badge-quiz" class="mission-item">📝 퀴즈</div>
        <div id="badge-fish" class="mission-item">🎣 낚시</div>
        <div id="badge-fossil" class="mission-item">⭐ 화석</div>
        <div id="badge-honey" class="mission-item">🐝 꿀단지</div>
    </div>

    <div id="dialog-box">
        <div id="npc-name-tag">이름</div>
        <div id="dialog-content">대화 내용</div>
        <div id="dialog-next">▼ [SPACE]</div>
    </div>

    <div id="fishing-game" class="ui-panel">
        <h2>🎣 순간 포착!</h2>
        <div id="fish-count">잡은 물고기: 0 / 3</div>
        <div id="fishing-countdown" style="font-size: 35px; color: #ff4444; font-weight: bold; margin: 10px 0; height: 45px;"></div>
        <p>커서가 노란색 칸에 있을 때<br>**[SPACE] 키를 정확히 누르세요!**</p>
        <div id="fishing-bar-bg">
            <div id="fishing-target"></div>
            <div id="fishing-cursor"></div>
        </div>
        <button class="restart-btn" style="padding: 5px 15px; font-size:18px; margin-top:0;" onclick="closeMinigame()">포기하기</button>
    </div>

    <div id="quiz-game" class="ui-panel">
        <h2>📝 너굴의 학교 상식 퀴즈</h2>
        <h3 id="quiz-progress">문제 1 / 3</h3>
        <p id="quiz-question" style="font-size: 28px; margin: 30px 0;">문제 내용</p>
        <p id="quiz-feedback" style="font-size: 40px; font-weight:bold; height: 50px; margin: 10px 0;"></p>
        <div>
            <button class="quiz-btn btn-o" onclick="answerQuiz(true)">O (맞다)</button>
            <button class="quiz-btn btn-x" onclick="answerQuiz(false)">X (아니다)</button>
        </div>
    </div>

    <div id="help-text">💡 스페이스바를 눌러 땅 파기</div>

    <div id="ending-screen">
        <h1>🎉 축제 미션 클리어! 🎉</h1>
        <p class="ending-msg">모든 주민을 도와주었어요!</p>
        <p id="final-time-text"></p>

        <div class="ranking-box">
            <h3>🏆 오늘의 명예의 전당 (Top 5)</h3>
            <div id="ranking-list"></div>
        </div>

        <p class="footer-msg">운영진에게 화면을 보여주고 선물을 받으세요.</p>
        <button class="restart-btn" onclick="restartGame()">처음으로 돌아가기</button>
    </div>
</div>

<script src="game.js"></script>
</body>
</html>